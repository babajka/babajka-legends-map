{"version":3,"sources":["common/Clickable.js","common/TextWithParagraphs.js","constants.js","utils.js","LegendModal.js","index.js"],"names":["Clickable","_ref","onClick","children","props","Object","objectWithoutProperties","react_default","a","createElement","assign","role","tabIndex","onKeyDown","event","key","TextWithParagraphs","paragraphs","text","split","lastParagraphIndex","length","map","paragraph","i","react","Fragment","GA_ID","staging","production","LIGHT_STYLE","concat","MINSK","BELARUS_BOUNDS","PropTypes","shape","id","number","isRequired","title","string","coordinates","arrayOf","emoji","getGoogleMapsUrl","_ref2","slicedToArray","lng","lat","zoom","arguments","undefined","track","options","process","REACT_APP_WIR_ENV","ReactGA","objectSpread","category","LegendModal","_ref$legend","legend","emojiCode","onClose","className","src","alt","href","rel","target","bind","action","label","formatcoords","format","latLonSeparator","decimalPlaces","common_TextWithParagraphs","Map","ReactMapboxGl","accessToken","minZoom","maxZoom","App","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleZoom","state","nextZoom","Math","round","getZoom","setState","setActiveLegendId","activeLegendId","legendsById","keyBy","legends","initialize","debug","pageview","document","location","pathname","_this2","_this$state","activeLegend","style","containerStyle","position","top","bottom","width","fitBounds","fitBoundsOptions","padding","center","onZoom","lib_esm","filter","common_Clickable","src_LegendModal","Component","rootElement","getElementById","ReactDOM","render","src_App","require"],"mappings":"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","file":"static/js/main.ba8b255c.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst Clickable = ({ onClick, children, ...props }) => (\n  <div\n    role=\"button\"\n    tabIndex={0}\n    onClick={onClick}\n    onKeyDown={event => {\n      if (event.key === 'Enter') {\n        onClick(event);\n      }\n    }}\n    {...props}\n  >\n    {children}\n  </div>\n);\n\nClickable.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  children: PropTypes.node.isRequired,\n};\n\nexport default Clickable;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\n\nconst TextWithParagraphs = ({ text }) => {\n  const paragraphs = text.split('\\n');\n  const lastParagraphIndex = paragraphs.length - 1;\n\n  return paragraphs.map((paragraph, i) => (\n    <Fragment key={i}>\n      {paragraph}\n      {i < lastParagraphIndex && (\n        <>\n          <br />\n          <br />\n        </>\n      )}\n    </Fragment>\n  ));\n};\n\nTextWithParagraphs.propTypes = {\n  text: PropTypes.string.isRequired,\n};\n\nexport default TextWithParagraphs;\n","import PropTypes from 'prop-types';\n\nexport const MAPBOX_ACCESS_TOKEN =\n  'pk.eyJ1IjoidWxhZGJvaGRhbiIsImEiOiJjam9kMDQ1NzYxOTYyM3FvanhpOXE1cDIzIn0.JiXb8lR9e53GqZz51PZdaQ';\n\nexport const GA_ID = {\n  staging: 'UA-117143376-4',\n  production: 'UA-117143376-3',\n};\n\nconst STYLE_PREFIX = 'mapbox://styles/uladbohdan';\n\nexport const LIGHT_STYLE = `${STYLE_PREFIX}/cjpjxmip00js22snnkwi85d4i`;\n\nexport const MINSK = [27.5615, 53.9045];\n\nexport const BELARUS_BOUNDS = [\n  23.178357, // west\n  51.261881, // south\n  32.776784, // east\n  56.139922, // north\n];\n\nexport const EMOJI_SCALE_RATE = 4.5;\n\nexport const LegendShape = PropTypes.shape({\n  id: PropTypes.number.isRequired,\n  title: PropTypes.string.isRequired,\n  coordinates: PropTypes.arrayOf(PropTypes.number).isRequired,\n  text: PropTypes.string.isRequired,\n  emoji: PropTypes.string.isRequired,\n});\n","import ReactGA from 'react-ga';\n\nexport const getGoogleMapsUrl = ([lng, lat], zoom = 7) =>\n  `http://www.google.com/maps/place/${lat},${lng}/@${lat},${lng},${zoom}z`;\n\nexport const track = options => {\n  if (!process.env.REACT_APP_WIR_ENV) {\n    return;\n  }\n  ReactGA.event({\n    category: 'Legends Map',\n    ...options,\n  });\n};\n","import React from 'react';\nimport formatcoords from 'formatcoords';\n\nimport TextWithParagraphs from './common/TextWithParagraphs';\n\nimport { LegendShape } from './constants';\nimport { getGoogleMapsUrl, track } from './utils';\n\nconst LegendModal = ({ legend: { emoji, emojiCode, coordinates, title, text }, onClose }) => (\n  <div className=\"legend__modal\">\n    <div className=\"legend__content\">\n      <div className=\"legend__top\">\n        <img className=\"legend__emoji\" src={`./images/${emojiCode}.png`} alt={title} />\n        <div className=\"legend__coords\">\n          <a\n            className=\"legend__coords_link\"\n            href={getGoogleMapsUrl(coordinates)}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n            onClick={track.bind(null, { action: 'google-map-opened', label: `${emoji} ${title}` })}\n          >\n            {formatcoords(coordinates, true).format('DD MM X', {\n              latLonSeparator: ', ',\n              decimalPlaces: 2,\n            })}\n          </a>\n        </div>\n        <div className=\"legend__title\">{title}</div>\n      </div>\n      <div className=\"legend__text\">\n        <TextWithParagraphs text={text} />\n      </div>\n      <button className=\"legend__close-button\" onClick={onClose}>\n        <i className=\"legend__close-icon fa fa-times\" />\n      </button>\n    </div>\n  </div>\n);\n\nLegendModal.propTypes = {\n  legend: LegendShape.isRequired,\n};\n\nexport default LegendModal;\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport ReactMapboxGl, { Marker, ZoomControl } from 'react-mapbox-gl';\nimport ReactGA from 'react-ga';\nimport keyBy from 'lodash/keyBy';\n\nimport Clickable from './common/Clickable';\nimport LegendModal from './LegendModal';\n\nimport { track } from './utils';\n\nimport {\n  MAPBOX_ACCESS_TOKEN,\n  GA_ID,\n  LIGHT_STYLE,\n  MINSK,\n  BELARUS_BOUNDS,\n  EMOJI_SCALE_RATE,\n  LegendShape,\n} from './constants';\nimport './styles.scss';\n\nconst Map = ReactMapboxGl({\n  accessToken: MAPBOX_ACCESS_TOKEN,\n  minZoom: 4,\n  maxZoom: 9,\n});\n\n// NOTE: When rendering many objects,\n// avoid using `Markers` as it will negatively affect performance.\n// Use `Layers` and `Features` instead.\n// https://github.com/alex3165/react-mapbox-gl/blob/master/docs/API.md#marker\n\nclass App extends Component {\n  static propTypes = {\n    legends: PropTypes.arrayOf(LegendShape).isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n    this.legendsById = keyBy(this.props.legends, 'id');\n    this.state = { activeLegendId: null };\n  }\n\n  componentDidMount() {\n    if (process.env.REACT_APP_WIR_ENV) {\n      ReactGA.initialize(GA_ID[process.env.REACT_APP_WIR_ENV], {\n        debug: false,\n      });\n      ReactGA.pageview(document.location.pathname);\n    }\n  }\n\n  handleZoom = map => {\n    const { zoom } = this.state;\n    const nextZoom = Math.round(map.getZoom());\n    if (nextZoom !== zoom) {\n      this.setState({ zoom: nextZoom });\n    }\n  };\n\n  setActiveLegendId = activeLegendId => this.setState({ activeLegendId });\n\n  render() {\n    const { legends } = this.props;\n    const { activeLegendId, zoom } = this.state;\n    const activeLegend = this.legendsById[activeLegendId];\n    return (\n      <>\n        <Map\n          style={LIGHT_STYLE}\n          containerStyle={{\n            position: 'absolute',\n            top: 0,\n            bottom: 0,\n            width: '100%',\n          }}\n          // TODO: fix calling `fitBounds` on window resizing\n          fitBounds={BELARUS_BOUNDS}\n          fitBoundsOptions={{\n            padding: 25,\n          }}\n          center={MINSK}\n          onZoom={this.handleZoom}\n        >\n          <ZoomControl />\n          {legends\n            .filter(({ emoji }) => emoji)\n            .map(({ id, title, coordinates, emoji, emojiCode }) => (\n              <Marker key={id} coordinates={coordinates}>\n                <Clickable\n                  onClick={() => {\n                    track({ action: 'emoji-clicked', label: `${emoji} ${title}` });\n                    this.setState({ activeLegendId: id });\n                  }}\n                >\n                  <img\n                    alt={emoji}\n                    src={`./images/${emojiCode}.png`}\n                    width={zoom * EMOJI_SCALE_RATE}\n                  />\n                </Clickable>\n              </Marker>\n            ))}\n        </Map>\n        {activeLegend && (\n          <LegendModal legend={activeLegend} onClose={() => this.setActiveLegendId(null)} />\n        )}\n        <div className=\"title title__map\">\n          Мапа <br /> беларускіх <br /> легенд\n        </div>\n        <div className=\"title title__wir-reference\">\n          Зроблена для <br /> пляцоўкі{' '}\n          <a href=\"http://wir.by\" target=\"_blank\" rel=\"noreferrer noopener\">\n            wir.by\n          </a>\n        </div>\n      </>\n    );\n  }\n}\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App legends={require('./legends')} />, rootElement);\n"],"sourceRoot":""}